View(output_table)
View(agonist_challenge_22DIV_25052023_1h)
View(agonist_challenge_22DIV_25052023_30min)
View(baseline_22DIV_25042023)
# assign output_table to analysis_dataset
analysis_dataset <- output_table
View(agonist_challenge_23DIV_25052023_24h)
View(agonist_challenge_22DIV_25052023_acute)
View(agonist_challenge_22DIV_25052023_30min)
View(agonist_challenge_22DIV_25052023_1h)
# assign output_table to analysis_dataset
analysis_dataset <- output_table
# calculate burst parameters
# note time intervals updates based on start of electrode_burst_recording
# number of bursts
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 10802.57616, 10922.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 11042.57616, 11162.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 12722.5004, 12842.5004, recording_identifier = "agonist_challenge_22DIV_25052023_30min")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 14522.11672, 14642.11672, recording_identifier = "agonist_challenge_22DIV_25052023_1h")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 0, 120, recording_identifier = "agonist_challenge_23DIV_25052023_24h")
# burst duration
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 10802.57616, 10922.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 11042.57616, 11162.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 12722.5004, 12842.5004, recording_identifier = "agonist_challenge_22DIV_25052023_30min")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 14522.11672, 14642.11672, recording_identifier = "agonist_challenge_22DIV_25052023_1h")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 0, 120, recording_identifier = "agonist_challenge_23DIV_25052023_24h")
# number of spikes per burst
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 10802.57616, 10922.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 11042.57616, 11162.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 12722.5004, 12842.5004, recording_identifier = "agonist_challenge_22DIV_25052023_30min")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 14522.11672, 14642.11672, recording_identifier = "agonist_challenge_22DIV_25052023_1h")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 0, 120, recording_identifier = "agonist_challenge_23DIV_25052023_24h")
# mean burst ISI
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 10802.57616, 10922.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 11042.57616, 11162.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 12722.5004, 12842.5004, recording_identifier = "agonist_challenge_22DIV_25052023_30min")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 14522.11672, 14642.11672, recording_identifier = "agonist_challenge_22DIV_25052023_1h")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 0, 120, recording_identifier = "agonist_challenge_23DIV_25052023_24h")
# create single electrode bar chart
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "number_of_bursts", electrode_filter = "A1_1|A1_2", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "burst_duration", electrode_filter = "A1_1|A1_2", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "spikes_per_burst", electrode_filter = "A1_1|A1_2", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "mean_burst_ISI", electrode_filter = "A1_1|A1_2", statistic = se)
# load electrode burst csv files
baseline_31DIV_04052023 <- create_electrode_dataset(data_path = "electrode_burst_files/Baseline_WT hippocampal culture_31DIV_04-05-2023(000)(000)_electrode_burst_list.csv",
recording_identifier = "baseline_31DIV_04052023")
blocker_challenge_31DIV_04052023_acute <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_31DIV_04-05-2023_BlockersChallenge(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_acute")
blocker_challenge_31DIV_04052023_30min <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_31DIV_04-05-2023_BlockersChallenge-30min(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_30min")
blocker_challenge_31DIV_04052023_1h <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_31DIV_04-05-2023_BlockersChallenge-1h(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_1h")
blocker_challenge_31DIV_04052023_24h <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_32DIV_05-05-2023_BlockersChallenge-24h(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# calculate burst parameters
# note time intervals updates based on start of electrode_burst_recording
# number of bursts
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 10802.57616, 10922.57616, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
# merge electrode burst datasets
output_table <- rbind(baseline_31DIV_04052023,
blocker_challenge_31DIV_04052023_acute,
blocker_challenge_31DIV_04052023_30min,
blocker_challenge_31DIV_04052023_1h,
blocker_challenge_31DIV_04052023_24h)
# assign output_table to analysis_dataset
analysis_dataset <- output_table
View(blocker_challenge_31DIV_04052023_acute)
View(agonist_challenge_22DIV_25052023_1h)
View(blocker_challenge_31DIV_04052023_30min)
View(blocker_challenge_31DIV_04052023_1h)
View(blocker_challenge_31DIV_04052023_24h)
# load electrode burst csv files
baseline_31DIV_04052023 <- create_electrode_dataset(data_path = "electrode_burst_files/Baseline_WT hippocampal culture_31DIV_04-05-2023(000)(000)_electrode_burst_list.csv",
recording_identifier = "baseline_31DIV_04052023")
blocker_challenge_31DIV_04052023_acute <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_31DIV_04-05-2023_BlockersChallenge(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_acute")
blocker_challenge_31DIV_04052023_30min <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_31DIV_04-05-2023_BlockersChallenge-30min(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_30min")
blocker_challenge_31DIV_04052023_1h <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_31DIV_04-05-2023_BlockersChallenge-1h(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_1h")
blocker_challenge_31DIV_04052023_24h <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_32DIV_05-05-2023_BlockersChallenge-24h(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# merge electrode burst datasets
output_table <- rbind(baseline_31DIV_04052023,
blocker_challenge_31DIV_04052023_acute,
blocker_challenge_31DIV_04052023_30min,
blocker_challenge_31DIV_04052023_1h,
blocker_challenge_31DIV_04052023_24h)
# assign output_table to analysis_dataset
analysis_dataset <- output_table
# calculate burst parameters
# note time intervals updates based on start of electrode_burst_recording
# number of bursts
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 4634.327, 4754.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 4874.327, 4994.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 6602.703, 6722.703, recording_identifier = "blocker_challenge_31DIV_04052023_30min")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 8403.371, 8523.371, recording_identifier = "blocker_challenge_31DIV_04052023_1h")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 122.3172, 242.3172, recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# burst duration
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 4634.327, 4754.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 4874.327, 4994.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 6602.703, 6722.703, recording_identifier = "blocker_challenge_31DIV_04052023_30min")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 8403.371, 8523.371, recording_identifier = "blocker_challenge_31DIV_04052023_1h")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 122.3172, 242.3172, recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# number of spikes per burst
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 4634.327, 4754.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 4874.327, 4994.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 6602.703, 6722.703, recording_identifier = "blocker_challenge_31DIV_04052023_30min")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 8403.371, 8523.371, recording_identifier = "blocker_challenge_31DIV_04052023_1h")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 122.3172, 242.3172, recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# mean burst ISI
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 4634.327, 4754.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 4874.327, 4994.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 6602.703, 6722.703, recording_identifier = "blocker_challenge_31DIV_04052023_30min")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 8403.371, 8523.371, recording_identifier = "blocker_challenge_31DIV_04052023_1h")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 122.3172, 242.3172, recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# create single electrode bar chart
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "number_of_bursts", electrode_filter = "A1_1|A1_2", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "burst_duration", electrode_filter = "A1_1|A1_2", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "mean_burst_ISI", electrode_filter = "A1_1|A1_2", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "mean_burst_ISI", electrode_filter = "A1_1|A1_2", statistic = se)
View(blocker_challenge_31DIV_04052023_1h)
# create single electrode bar chart
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "number_of_bursts", electrode_filter = "A1_1|A1_2", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "burst_duration", electrode_filter = "A1_1|A1_2", statistic = se)
View(blocker_challenge_31DIV_04052023_acute)
# assign output_table to analysis_dataset
analysis_dataset <- output_table
# calculate burst parameters
# note time intervals updates based on start of electrode_burst_recording
# number of bursts
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 4634.327, 4754.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
View(analysis_dataset)
# create single electrode bar chart
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "number_of_bursts", electrode_filter = "A1_1|A1_2", statistic = se)
# create single electrode bar chart
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "number_of_bursts", statistic = se)
# assign output_table to analysis_dataset
analysis_dataset <- output_table
# calculate burst parameters
# note time intervals updates based on start of electrode_burst_recording
# number of bursts
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 4634.327, 4754.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 4874.327, 4994.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 6602.703, 6722.703, recording_identifier = "blocker_challenge_31DIV_04052023_30min")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 8403.371, 8523.371, recording_identifier = "blocker_challenge_31DIV_04052023_1h")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 122.3172, 242.3172, recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# create single electrode bar chart
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "number_of_bursts", electrode_filter = "A1_1|A1_2", statistic = se)
# create single electrode bar chart
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "number_of_bursts", statistic = se)
# assign output_table to analysis_dataset
analysis_dataset <- output_table
# calculate burst parameters
# note time intervals updates based on start of electrode_burst_recording
# number of bursts
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 4634.327, 4754.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
View(analysis_dataset)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "number_of_bursts", electrode_filter = "A6", statistic = se)
data = analysis_dataset
electrode_parameter = "number_of_bursts"
electrode_filter = "A6"
#filter data for plotting
analysis_dataset <- data %>%
select(-c(Time_s, Duration_s, Size_spikes, Recording_identifier)) %>%
distinct() %>%
filter(., str_detect(Electrode, electrode_filter))
View(analysis_dataset)
if (electrode_parameter == "number_of_bursts") {
y_axis_title <- "Number of Bursts"
analysis_dataset_2 <- select(analysis_dataset, "Electrode"|contains("electrode_number_of_bursts"))
} else if (electrode_parameter == "burst_duration") {
y_axis_title <- "Burst Duration - Average (sec)"
analysis_dataset_2 <- select(analysis_dataset, "Electrode"|contains("electrode_duration_raw")|contains("electrode_duration_mean")|contains("electrode_duration_sd")|contains("electrode_duration_se"))
colnames(analysis_dataset_2) = gsub("electrode_duration_", "", colnames(analysis_dataset_2))
} else if (electrode_parameter == "spikes_per_burst") {
y_axis_title <- "Number of Spikes per Burst - Average"
analysis_dataset_2 <- select(analysis_dataset, "Electrode"|contains("electrode_spikes_raw")|contains("electrode_spikes_mean")|contains("electrode_spikes_sd")|contains("electrode_spikes_se"))
colnames(analysis_dataset_2) = gsub("electrode_spikes_", "", colnames(analysis_dataset_2))
} else if (electrode_parameter == "mean_burst_ISI") {
y_axis_title <- "Mean ISI within Burst - Average (sec)"
analysis_dataset_2 <- select(analysis_dataset, "Electrode"|contains("electrode_raw_mean_burst_ISI")|contains("electrode_avg_mean_burst_ISI")|contains("electrode_sd_mean_burst_ISI")|contains("electrode_se_mean_burst_ISI"))
colnames(analysis_dataset_2) = gsub("_mean_burst_ISI", "", colnames(analysis_dataset_2))
colnames(analysis_dataset_2) = gsub("electrode_", "", colnames(analysis_dataset_2))
colnames(analysis_dataset_2) = gsub("avg", "mean", colnames(analysis_dataset_2))
}  else {
}
View(analysis_dataset_2)
#reformat data for plotting
analysis_dataset_3 <- melt(analysis_dataset_2, id = "Electrode")
analysis_dataset_3$recording_time = gsub(pattern = ".*:", replacement = "", x = analysis_dataset_3$variable)
analysis_dataset_3$parameter = gsub(pattern = "\\:.*", replacement = "", x = analysis_dataset_3$variable)
analysis_dataset_3 <- analysis_dataset_3 %>%
select(-c(variable))
View(analysis_dataset_3)
if (electrode_parameter == "number_of_bursts") {
#remove duplicate rows where value is NA (grouped by electrode, recording_time, and parameter)
analysis_dataset_4 <- analysis_dataset_3 %>%
group_by(Electrode, recording_time, parameter) %>%
slice(which.max(!is.na(value)))
#pivot data wider so can plot individual columns
analysis_dataset_5 <- analysis_dataset_4 %>%
pivot_wider(id_cols = c(Electrode, recording_time),
names_from = parameter,
values_from = value)
}  else {
# create data frame of raw values
raw_values <- analysis_dataset_3 %>%
filter(., parameter == "raw")
# create data frame of distinct calculated statistics
calculated_statistics <- analysis_dataset_3 %>%
filter(., parameter != "raw") %>%
distinct() %>%
group_by(Electrode, recording_time, parameter) %>%
slice(which.max(!is.na(value)))
# pivot raw data wider so can plot
analysis_dataset_4 <- raw_values %>%
pivot_wider(id_cols = c(Electrode, recording_time),
names_from = parameter,
values_from = value,
values_fn = list) %>%
unnest(cols = c(raw))
# pivot data wider so can plot individual columns
analysis_dataset_5 <- calculated_statistics %>%
pivot_wider(id_cols = c(Electrode, recording_time),
names_from = parameter,
values_from = value,
values_fn = list)
# reassign column name and class
analysis_dataset_5[, 3:5] <- sapply(analysis_dataset_5[, 3:5], as.numeric)
}
View(analysis_dataset_5)
View(analysis_dataset_4)
View(analysis_dataset_3)
View(analysis_dataset_2)
View(analysis_dataset_3)
View(output_table)
analysis_dataset_test <- electrode_number_of_bursts(data = analysis_dataset, 4634.327, 4754.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
# load electrode burst csv files
baseline_31DIV_04052023 <- create_electrode_dataset(data_path = "electrode_burst_files/Baseline_WT hippocampal culture_31DIV_04-05-2023(000)(000)_electrode_burst_list.csv",
recording_identifier = "baseline_31DIV_04052023")
blocker_challenge_31DIV_04052023_acute <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_31DIV_04-05-2023_BlockersChallenge(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_acute")
blocker_challenge_31DIV_04052023_30min <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_31DIV_04-05-2023_BlockersChallenge-30min(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_30min")
blocker_challenge_31DIV_04052023_1h <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_31DIV_04-05-2023_BlockersChallenge-1h(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_1h")
blocker_challenge_31DIV_04052023_24h <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_32DIV_05-05-2023_BlockersChallenge-24h(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# merge electrode burst datasets
output_table <- rbind(baseline_31DIV_04052023,
blocker_challenge_31DIV_04052023_acute,
blocker_challenge_31DIV_04052023_30min,
blocker_challenge_31DIV_04052023_1h,
blocker_challenge_31DIV_04052023_24h)
# assign output_table to analysis_dataset
analysis_dataset <- output_table
# calculate burst parameters
# note time intervals updates based on start of electrode_burst_recording
# number of bursts
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 4634.327, 4754.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 4874.327, 4994.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 6602.703, 6722.703, recording_identifier = "blocker_challenge_31DIV_04052023_30min")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 8403.371, 8523.371, recording_identifier = "blocker_challenge_31DIV_04052023_1h")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 122.3172, 242.3172, recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# create single electrode bar chart
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "number_of_bursts", electrode_filter = "A1_1|A1_2", statistic = se)
test <- analysis_dataset
data = analysis_dataset
electrode_parameter = "number_of_bursts"
electrode_filter = "A6"
View(test)
#filter data for plotting
analysis_dataset <- data %>%
select(-c(Time_s, Duration_s, Size_spikes, Recording_identifier)) %>%
distinct() %>%
filter(., str_detect(Electrode, electrode_filter))
View(analysis_dataset)
View(data)
analysis_dataset <- data %>%
select(-c(Time_s, Duration_s, Size_spikes)) %>%
distinct() %>%
filter(., str_detect(Electrode, electrode_filter))
#filter data for plotting
analysis_dataset <- data %>%
select(-c(Time_s, Duration_s, Size_spikes, Recording_identifier)) %>%
distinct() %>%
filter(., str_detect(Electrode, electrode_filter))
other_analysis <- data %>%
select(-c(Time_s, Duration_s, Size_spikes)) %>%
distinct() %>%
filter(., str_detect(Electrode, electrode_filter))
View(other_analysis)
analysis_dataset <- data %>%
select(-c(Time_s, Duration_s, Size_spikes)) %>%
distinct() %>%
filter(., str_detect(Electrode, electrode_filter))
if (electrode_parameter == "number_of_bursts") {
y_axis_title <- "Number of Bursts"
analysis_dataset_2 <- select(analysis_dataset, "Electrode"|contains("electrode_number_of_bursts"))
} else if (electrode_parameter == "burst_duration") {
y_axis_title <- "Burst Duration - Average (sec)"
analysis_dataset_2 <- select(analysis_dataset, "Electrode"|contains("electrode_duration_raw")|contains("electrode_duration_mean")|contains("electrode_duration_sd")|contains("electrode_duration_se"))
colnames(analysis_dataset_2) = gsub("electrode_duration_", "", colnames(analysis_dataset_2))
} else if (electrode_parameter == "spikes_per_burst") {
y_axis_title <- "Number of Spikes per Burst - Average"
analysis_dataset_2 <- select(analysis_dataset, "Electrode"|contains("electrode_spikes_raw")|contains("electrode_spikes_mean")|contains("electrode_spikes_sd")|contains("electrode_spikes_se"))
colnames(analysis_dataset_2) = gsub("electrode_spikes_", "", colnames(analysis_dataset_2))
} else if (electrode_parameter == "mean_burst_ISI") {
y_axis_title <- "Mean ISI within Burst - Average (sec)"
analysis_dataset_2 <- select(analysis_dataset, "Electrode"|contains("electrode_raw_mean_burst_ISI")|contains("electrode_avg_mean_burst_ISI")|contains("electrode_sd_mean_burst_ISI")|contains("electrode_se_mean_burst_ISI"))
colnames(analysis_dataset_2) = gsub("_mean_burst_ISI", "", colnames(analysis_dataset_2))
colnames(analysis_dataset_2) = gsub("electrode_", "", colnames(analysis_dataset_2))
colnames(analysis_dataset_2) = gsub("avg", "mean", colnames(analysis_dataset_2))
}  else {
}
View(analysis_dataset_2)
#reformat data for plotting
analysis_dataset_3 <- melt(analysis_dataset_2, id = "Electrode")
analysis_dataset_3$recording_time = gsub(pattern = ".*:", replacement = "", x = analysis_dataset_3$variable)
analysis_dataset_3$parameter = gsub(pattern = "\\:.*", replacement = "", x = analysis_dataset_3$variable)
analysis_dataset_3 <- analysis_dataset_3 %>%
select(-c(variable))
#filter data for plotting
analysis_dataset <- data %>%
select(-c(Time_s, Duration_s, Size_spikes, Recording_identifier)) %>%
distinct() %>%
filter(., str_detect(Electrode, electrode_filter))
if (electrode_parameter == "number_of_bursts") {
y_axis_title <- "Number of Bursts"
analysis_dataset_2 <- select(analysis_dataset, "Electrode"|contains("electrode_number_of_bursts"))
} else if (electrode_parameter == "burst_duration") {
y_axis_title <- "Burst Duration - Average (sec)"
analysis_dataset_2 <- select(analysis_dataset, "Electrode"|contains("electrode_duration_raw")|contains("electrode_duration_mean")|contains("electrode_duration_sd")|contains("electrode_duration_se"))
colnames(analysis_dataset_2) = gsub("electrode_duration_", "", colnames(analysis_dataset_2))
} else if (electrode_parameter == "spikes_per_burst") {
y_axis_title <- "Number of Spikes per Burst - Average"
analysis_dataset_2 <- select(analysis_dataset, "Electrode"|contains("electrode_spikes_raw")|contains("electrode_spikes_mean")|contains("electrode_spikes_sd")|contains("electrode_spikes_se"))
colnames(analysis_dataset_2) = gsub("electrode_spikes_", "", colnames(analysis_dataset_2))
} else if (electrode_parameter == "mean_burst_ISI") {
y_axis_title <- "Mean ISI within Burst - Average (sec)"
analysis_dataset_2 <- select(analysis_dataset, "Electrode"|contains("electrode_raw_mean_burst_ISI")|contains("electrode_avg_mean_burst_ISI")|contains("electrode_sd_mean_burst_ISI")|contains("electrode_se_mean_burst_ISI"))
colnames(analysis_dataset_2) = gsub("_mean_burst_ISI", "", colnames(analysis_dataset_2))
colnames(analysis_dataset_2) = gsub("electrode_", "", colnames(analysis_dataset_2))
colnames(analysis_dataset_2) = gsub("avg", "mean", colnames(analysis_dataset_2))
}  else {
}
#reformat data for plotting
analysis_dataset_3 <- melt(analysis_dataset_2, id = "Electrode")
analysis_dataset_3$recording_time = gsub(pattern = ".*:", replacement = "", x = analysis_dataset_3$variable)
analysis_dataset_3$parameter = gsub(pattern = "\\:.*", replacement = "", x = analysis_dataset_3$variable)
analysis_dataset_3 <- analysis_dataset_3 %>%
select(-c(variable))
#remove duplicate rows where value is NA (grouped by electrode, recording_time, and parameter)
analysis_dataset_4 <- analysis_dataset_3 %>%
group_by(Electrode, recording_time, parameter) %>%
slice(which.max(!is.na(value)))
View(analysis_dataset_4)
View(analysis_dataset_3)
analysis_dataset_4 <- analysis_dataset_3 %>%
group_by(Electrode, recording_time, parameter) %>%
distinct()
analysis_dataset_4 <- analysis_dataset_3 %>%
group_by(Electrode, recording_time, parameter) %>%
slice_min()
analysis_dataset_4 <- analysis_dataset_3 %>%
group_by(Electrode, recording_time, parameter) %>%
slice_min(order_by = c(Electrode, recording_time))
analysis_dataset_4 <- analysis_dataset_3 %>%
group_by(Electrode, recording_time, parameter) %>%
slice_min(order_by = Electrode)
analysis_dataset_4 <- analysis_dataset_3 %>%
group_by(Electrode, recording_time, parameter) %>%
filter(value == max(value))
analysis_dataset_4 <- analysis_dataset_3 %>%
group_by(Electrode, recording_time, parameter) %>%
filter(value == max(value)) %>% ungroup()
#pivot data wider so can plot individual columns
analysis_dataset_5 <- analysis_dataset_4 %>%
pivot_wider(id_cols = c(Electrode, recording_time),
names_from = parameter,
values_from = value)
analysis_dataset_4 <- analysis_dataset_3 %>%
group_by(Electrode, recording_time, parameter) %>%
filter(value == max(value)) %>% dinstinct() %>%  ungroup()
analysis_dataset_4 <- analysis_dataset_3 %>%
group_by(Electrode, recording_time, parameter) %>%
filter(value == max(value)) %>% distinct() %>%  ungroup()
#pivot data wider so can plot individual columns
analysis_dataset_5 <- analysis_dataset_4 %>%
pivot_wider(id_cols = c(Electrode, recording_time),
names_from = parameter,
values_from = value)
# plot barchart
if (electrode_parameter == "number_of_bursts") {
analysis_dataset_5 %>%
ggplot(aes(x = Electrode, y = electrode_number_of_bursts, fill = recording_time)) +
geom_bar(stat='identity', position=position_dodge()) +
labs(fill = "Time Interval", y = y_axis_title)
} else {
analysis_dataset_5 %>%
ggplot(aes(x = Electrode, y = mean, fill = recording_time)) +
geom_bar(stat='identity', position=position_dodge()) +
geom_errorbar(aes(ymin = mean - {{statistic}}, ymax = mean + {{statistic}}), linewidth = 0.4, colour = "orange", alpha = 0.9, size = 1.5, position=position_dodge()) +
geom_point(data = analysis_dataset_4, aes(x = Electrode, y = raw, fill = recording_time), position = position_jitterdodge(jitter.width = 0.1, dodge.width = 0.9)) +
labs(fill = "Time Interval", y = y_axis_title)
}
# load MEA analysis package
library(MEAanalysis)
# load electrode burst csv files
baseline_22DIV_25042023 <- create_electrode_dataset(data_path = "electrode_burst_files/Baseline_WT hippocampal culture_22DIV_25-04-2023(000)_electrode_burst_list.csv",
recording_identifier = "baseline_22DIV_25042023")
agonist_challenge_22DIV_25052023_acute <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_22DIV_Agonists Challenge_25-04-2023(000)_electrode_burst_list.csv",
recording_identifier = "agonist_challenge_22DIV_25052023_acute")
agonist_challenge_22DIV_25052023_30min <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_22DIV_Agonists Challenge_30min after_25-04-2023(000)_electrode_burst_list.csv",
recording_identifier = "agonist_challenge_22DIV_25052023_30min")
agonist_challenge_22DIV_25052023_1h <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_22DIV_Agonists Challenge_1h after_25-04-2023(000)_electrode_burst_list.csv",
recording_identifier = "agonist_challenge_22DIV_25052023_1h")
agonist_challenge_23DIV_25052023_24h <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_23DIV_Agonists Challenge_24h after_26-04-2023(000)(000)_electrode_burst_list.csv",
recording_identifier = "agonist_challenge_23DIV_25052023_24h")
# merge electrode burst datasets
output_table <- rbind(baseline_22DIV_25042023,
agonist_challenge_22DIV_25052023_acute,
agonist_challenge_22DIV_25052023_30min,
agonist_challenge_22DIV_25052023_1h,
agonist_challenge_23DIV_25052023_24h)
# assign output_table to analysis_dataset
analysis_dataset <- output_table
# calculate burst parameters
# note time intervals updates based on start of electrode_burst_recording
# number of bursts
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 10802.57616, 10922.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 11042.57616, 11162.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 12722.5004, 12842.5004, recording_identifier = "agonist_challenge_22DIV_25052023_30min")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 14522.11672, 14642.11672, recording_identifier = "agonist_challenge_22DIV_25052023_1h")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 0, 120, recording_identifier = "agonist_challenge_23DIV_25052023_24h")
# burst duration
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 10802.57616, 10922.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 11042.57616, 11162.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 12722.5004, 12842.5004, recording_identifier = "agonist_challenge_22DIV_25052023_30min")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 14522.11672, 14642.11672, recording_identifier = "agonist_challenge_22DIV_25052023_1h")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 0, 120, recording_identifier = "agonist_challenge_23DIV_25052023_24h")
# number of spikes per burst
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 10802.57616, 10922.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 11042.57616, 11162.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 12722.5004, 12842.5004, recording_identifier = "agonist_challenge_22DIV_25052023_30min")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 14522.11672, 14642.11672, recording_identifier = "agonist_challenge_22DIV_25052023_1h")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 0, 120, recording_identifier = "agonist_challenge_23DIV_25052023_24h")
# mean burst ISI
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 10802.57616, 10922.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 11042.57616, 11162.57616, recording_identifier = "agonist_challenge_22DIV_25052023_acute")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 12722.5004, 12842.5004, recording_identifier = "agonist_challenge_22DIV_25052023_30min")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 14522.11672, 14642.11672, recording_identifier = "agonist_challenge_22DIV_25052023_1h")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 0, 120, recording_identifier = "agonist_challenge_23DIV_25052023_24h")
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "number_of_bursts", electrode_filter = "A6", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "burst_duration", electrode_filter = "A1_1|A1_2", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "spikes_per_burst", electrode_filter = "A1_1|A1_2", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "mean_burst_ISI", electrode_filter = "A1_1|A1_2", statistic = se)
# load electrode burst csv files
baseline_31DIV_04052023 <- create_electrode_dataset(data_path = "electrode_burst_files/Baseline_WT hippocampal culture_31DIV_04-05-2023(000)(000)_electrode_burst_list.csv",
recording_identifier = "baseline_31DIV_04052023")
blocker_challenge_31DIV_04052023_acute <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_31DIV_04-05-2023_BlockersChallenge(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_acute")
blocker_challenge_31DIV_04052023_30min <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_31DIV_04-05-2023_BlockersChallenge-30min(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_30min")
blocker_challenge_31DIV_04052023_1h <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_31DIV_04-05-2023_BlockersChallenge-1h(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_1h")
blocker_challenge_31DIV_04052023_24h <- create_electrode_dataset(data_path = "electrode_burst_files/WT hippocampal culture_32DIV_05-05-2023_BlockersChallenge-24h(000)_electrode_burst_list.csv",
recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# merge electrode burst datasets
output_table <- rbind(baseline_31DIV_04052023,
blocker_challenge_31DIV_04052023_acute,
blocker_challenge_31DIV_04052023_30min,
blocker_challenge_31DIV_04052023_1h,
blocker_challenge_31DIV_04052023_24h)
# assign output_table to analysis_dataset
analysis_dataset <- output_table
# calculate burst parameters
# note time intervals updates based on start of electrode_burst_recording
# number of bursts
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 4634.327, 4754.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 4874.327, 4994.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 6602.703, 6722.703, recording_identifier = "blocker_challenge_31DIV_04052023_30min")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 8403.371, 8523.371, recording_identifier = "blocker_challenge_31DIV_04052023_1h")
analysis_dataset <- electrode_number_of_bursts(data = analysis_dataset, 122.3172, 242.3172, recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# burst duration
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 4634.327, 4754.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 4874.327, 4994.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 6602.703, 6722.703, recording_identifier = "blocker_challenge_31DIV_04052023_30min")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 8403.371, 8523.371, recording_identifier = "blocker_challenge_31DIV_04052023_1h")
analysis_dataset <- electrode_burst_duration(data = analysis_dataset, 122.3172, 242.3172, recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# number of spikes per burst
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 4634.327, 4754.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 4874.327, 4994.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 6602.703, 6722.703, recording_identifier = "blocker_challenge_31DIV_04052023_30min")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 8403.371, 8523.371, recording_identifier = "blocker_challenge_31DIV_04052023_1h")
analysis_dataset <- electrode_spikes_per_burst(data = analysis_dataset, 122.3172, 242.3172, recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# mean burst ISI
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 4634.327, 4754.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 4874.327, 4994.327, recording_identifier = "blocker_challenge_31DIV_04052023_acute")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 6602.703, 6722.703, recording_identifier = "blocker_challenge_31DIV_04052023_30min")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 8403.371, 8523.371, recording_identifier = "blocker_challenge_31DIV_04052023_1h")
analysis_dataset <- electrode_mean_burst_ISI(data = analysis_dataset, 122.3172, 242.3172, recording_identifier = "blocker_challenge_31DIV_04052023_24h")
# create single electrode bar chart
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "number_of_bursts", electrode_filter = "A1_1|A1_2", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "burst_duration", electrode_filter = "A1_1|A1_2", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "spikes_per_burst", electrode_filter = "A1_1|A1_2", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "mean_burst_ISI", electrode_filter = "A1_1|A1_2", statistic = se)
View(output_table)
View(blocker_challenge_31DIV_04052023_30min)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "number_of_bursts", electrode_filter = "A6", statistic = se)
single_electrode_barchart(data = analysis_dataset, electrode_parameter = "burst_duration", electrode_filter = "A6", statistic = se)
